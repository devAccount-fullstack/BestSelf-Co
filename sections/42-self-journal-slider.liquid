{% liquid
  assign metaobject_content = section.settings.metaobject_content

  assign blocks = section.blocks
  assign section_id = section.settings.section_id
  assign section_text = section.settings.section_text
  assign section_title = section.settings.section_title
  assign btn_text = section.settings.btn_text

  assign pt_mob = section.settings.pt_mob
  assign pb_mob = section.settings.pb_mob
  assign pt_tab = section.settings.pt_tab
  assign pb_tab = section.settings.pb_tab
  assign pt_desk = section.settings.pt_desk
  assign pb_desk = section.settings.pb_desk
%}

{% render 'section-paddings',
  section_id: section.id,
  pt_mob: pt_mob,
  pb_mob: pb_mob,
  pt_tab: pt_tab,
  pb_tab: pb_tab,
  pt_desk: pt_desk,
  pb_desk: pb_desk
%}

<div id="{{ section_id | handleize }}" data-section-id="{{ section.id }}" x-data="selfJournalSlider">
  <div class="container-42">
    <div class="tw-flex tw-flex-col lg:tw-flex-row lg:tw-items-center tw-gap-4 lg:tw-justify-between">
      <div class="md:tw-max-w-[398px]">
        {% if section_title != blank %}
          <div
            class="lg:tw-max-w-[324px] tw-text-black tw-text-[28px] lg:tw-text-[48px] lg:tw-leading-[64px] tw-leading-[35px]"
          >
            {{ section_title }}
          </div>
        {% endif %}
        {% if section_text != blank %}
          <p class="tw-text-black tw-font-normal md:tw-text-base tw-text-sm tw-leading-[22px] lg:tw-mt-[11px] tw-mt-2.5">
            {{ section_text }}
          </p>
        {% endif %}
        <div
          class="tw-flex lg:tw-flex-col lg:tw-items-start md:tw-justify-start tw-items-center tw-gap-2.5 tw-mt-4 tw-justify-center"
        >
          <span class="tw-text-sc-blue md:tw-text-[17px] md:tw-leading-[23px] tw-text-base tw-font-bold">
            {{ btn_text }}
          </span>

          <button
            @click="activeSecondaryImage = !activeSecondaryImage"
            :class="activeSecondaryImage ? 'tw-bg-[#2C3C60]' : 'tw-bg-[#D1D1D1]'"
            class="tw-relative tw-w-[68px] tw-h-8.5 lg:tw-w-[74px] lg:tw-h-10 tw-rounded-[120px] tw-duration-300 tw-flex tw-shrink-0 tw-justify-between tw-items-center"
          >
            <span
              x-show="activeSecondaryImage"
              class="lg:tw-pl-1.5 tw-pl-[5.5px] tw-text-white tw-text-[15px] tw-font-medium"
              >ON</span
            >
            <span
              x-show="!activeSecondaryImage"
              class="tw-ml-auto lg:tw-pr-1.5 tw-pr-[5.5px] tw-text-white tw-text-[15px] tw-font-medium"
              >OFF</span
            >
            <span
              class="tw-absolute lg:tw-top-1 tw-top-[3px] lg:tw-bottom-1 tw-bottom-[3px] tw-w-7 tw-h-7 lg:tw-w-8 lg:tw-h-8 tw-rounded-full tw-bg-white tw-flex tw-items-center tw-justify-center tw-transition-all tw-duration-300"
              :class="activeSecondaryImage ? 'lg:tw-left-[52%] tw-left-[54%]' : 'tw-left-[3px] lg:tw-left-1'"
            ></span>
          </button>
        </div>
      </div>

      <div class="lg:tw-w-[67.1%] md:tw-flex md:tw-items-center md:tw-gap-4">
        <!-- SWIPER BUTTON PREV DESKTOP -->
        <div class="self-slider-btn-prev tw-hidden md:tw-flex tw-shrink-0 tw-cursor-pointer">
          {% render 'icon-42', name: 'swiper-btn', class: 'tw-rotate-180' %}
        </div>

        <div class="tw-w-full tw-overflow-hidden">
          <!-- CUSTOM PAGINATION -->
          <div class="tw-px-1 md:tw-grid tw-grid-cols-4 tw-mb-4 tw-hidden tw-w-full">
            {% if metaobject_content != blank %}
              {% for item in metaobject_content %}
                <button
                  @click="goToSlide({{ forloop.index0 }})"
                  type="button"
                  class="tw-relative tw-flex-col tw-flex tw-items-center tw-gap-5"
                >
                  {% liquid
                    assign line_class = ''
                    if forloop.first
                      assign line_class = 'tw-w-1/2 tw-right-0'
                    elsif forloop.last
                      assign line_class = 'tw-w-1/2 tw-left-0'
                    else
                      assign line_class = 'tw-w-full'
                    endif
                  %}
                  <span
                    class="tw-absolute tw-bg-sc-blue tw-opacity-50 tw-h-[1px] tw-flex tw-top-[4.5px] {{ line_class }}"
                  ></span>

                  <span class="tw-relative tw-z-5 tw-px-2 tw-bg-white tw-block">
                    <span
                      :class="{'tw-opacity-50' : activeIndex !== {{ forloop.index0 }} }"
                      class="tw-w-2.5 tw-h-2.5 tw-block tw-rounded-full tw-bg-sc-blue"
                    ></span>
                  </span>
                  <h3
                    :class="{'tw-opacity-50' : activeIndex !== {{ forloop.index0 }} }"
                    class="tw-font-bold tw-text-sc-blue tw-text-base !tw-leading-[20px]"
                  >
                    {{ item.journal_heading }}
                  </h3>
                </button>
              {% endfor %}
            {% else %}
              {% for block in blocks %}
                <button
                  @click="goToSlide({{ forloop.index0 }})"
                  type="button"
                  class="tw-relative tw-flex-col tw-flex tw-items-center tw-gap-5"
                >
                  {% liquid
                    assign line_class = ''
                    if forloop.first
                      assign line_class = 'tw-w-1/2 tw-right-0'
                    elsif forloop.last
                      assign line_class = 'tw-w-1/2 tw-left-0'
                    else
                      assign line_class = 'tw-w-full'
                    endif
                  %}
                  <span
                    class="tw-absolute tw-bg-sc-blue tw-opacity-50 tw-h-[1px] tw-flex tw-top-[4.5px] {{ line_class }}"
                  ></span>

                  <span class="tw-relative tw-z-5 tw-px-2 tw-bg-white tw-block">
                    <span
                      :class="{'tw-opacity-50' : activeIndex !== {{ forloop.index0 }} }"
                      class="tw-w-2.5 tw-h-2.5 tw-block tw-rounded-full tw-bg-sc-blue"
                    ></span>
                  </span>
                  <h3
                    :class="{'tw-opacity-50' : activeIndex !== {{ forloop.index0 }} }"
                    class="tw-font-bold tw-text-sc-blue tw-text-base !tw-leading-[20px]"
                  >
                    {{ block.settings.name_pagination }}
                  </h3>
                </button>
              {% endfor %}
            {% endif %}
          </div>

          <!-- SWIPER -->
          <div
            class="swiper"
            x-ref="mainSlider"
          >
            <div class="swiper-wrapper">
              {% if metaobject_content != blank %}
                {% for item in metaobject_content %}
                  {% liquid
                    assign image_default = item.blank_image
                    assign image_active = item.filled_image
                    assign name_pagination = item.journal_heading
                    assign text = item.journal_text
                    assign text_active = item.text_active
                  %}
                  <div class="swiper-slide">
                    <div x-show="!activeSecondaryImage">
                      <img src="{{ image_default |  img_url: 'master' }}" alt="blank_image" class="tw-max-w-full">
                    </div>

                    <!-- ACTIVE IMAGE -->
                    <div x-show="activeSecondaryImage" x-cloak>
                      <img src="{{ image_active |  img_url: 'master' }}" alt="filled_image" class="tw-max-w-full">
                    </div>

                    <!-- MOBILE CONTENT -->
                    <div class="tw-mt-4 md:tw-hidden tw-flex tw-flex-col tw-py-5 tw-gap-1.5">
                      <h4 class="tw-text-sc-blue tw-text-lg tw-leading-[22px] tw-text-center tw-font-bold">
                        {{ name_pagination }}
                      </h4>
                      <p class="tw-text-sc-blue tw-text-sm tw-leading-[22px] tw-font-normal">
                        {{ text }}
                      </p>
                    </div>

                    <!-- DESKTOP CONTENT -->
                    <div class="tw-mt-4 tw-hidden  md:tw-flex">
                      <p
                        x-show="!activeSecondaryImage"
                        class="tw-text-sc-blue tw-text-base tw-text-center tw-font-normal"
                      >
                        {{ text }}
                      </p>
                      <p
                        x-cloak
                        x-show="activeSecondaryImage"
                        class="tw-text-sc-blue tw-text-base tw-text-center tw-font-normal"
                      >
                        {% if text_active != blank %}
                          {{ text_active }}
                        {% else %}
                          {{ text }}
                        {% endif %}
                      </p>
                    </div>
                  </div>
                {% endfor %}
              {% else %}
                {% for block in blocks %}
                  {% liquid
                    assign image_default = block.settings.image_default
                    assign image_active = block.settings.image_active
                    assign name_pagination = block.settings.name_pagination
                    assign text = block.settings.text
                    assign text_active = block.settings.text_active
                  %}
                  <div class="swiper-slide">
                    <div x-show="!activeSecondaryImage">
                      <img
                        src="{{ image_default | img_url: 'master' }}"
                        alt="{{ image_default.alt }}"
                        loading="lazy"
                        class="tw-max-w-full"
                      >
                    </div>

                    <!-- ACTIVE IMAGE -->
                    <div x-show="activeSecondaryImage" x-cloak>
                      <img
                        src="{{ image_active | img_url: 'master' }}"
                        alt="{{ image_active.alt }}"
                        loading="lazy"
                        class="tw-max-w-full"
                      >
                    </div>

                    <!-- MOBILE CONTENT -->
                    <div class="tw-mt-4 md:tw-hidden tw-flex tw-flex-col tw-py-5 tw-gap-1.5">
                      <h4 class="tw-text-sc-blue tw-text-lg tw-leading-[22px] tw-text-center tw-font-bold">
                        {{ name_pagination }}
                      </h4>
                      <p class="tw-text-sc-blue tw-text-sm tw-leading-[22px] tw-font-normal">
                        {{ text }}
                      </p>
                    </div>

                    <!-- DESKTOP CONTENT -->
                    <div class="tw-mt-4 tw-hidden  md:tw-flex">
                      <p
                        x-show="!activeSecondaryImage"
                        class="tw-text-sc-blue tw-text-base tw-text-center tw-font-normal"
                      >
                        {{ text }}
                      </p>
                      <p
                        x-cloak
                        x-show="activeSecondaryImage"
                        class="tw-text-sc-blue tw-text-base tw-text-center tw-font-normal"
                      >
                        {% if text_active != blank %}
                          {{ text_active }}
                        {% else %}
                          {{ text }}
                        {% endif %}
                      </p>
                    </div>
                  </div>
                {% endfor %}
              {% endif %}
            </div>
          </div>
        </div>

        <!-- SWIPER BUTTON NEXT DESKTOP -->
        <div class="self-slider-btn-next tw-hidden md:tw-flex tw-shrink-0 tw-cursor-pointer">
          {% render 'icon-42', name: 'swiper-btn', class: '' %}
        </div>

        <!-- SLIDER BUTTONS MOBILE -->
        <div class="md:tw-hidden tw-flex tw-gap-[13px] tw-mt-4 justify-center">
          <div class="self-slider-btn-prev tw-opacity-50">
            {% render 'icon-42', name: 'swiper-btn', class: 'tw-rotate-180' %}
          </div>
          <div class="self-slider-btn-next">{% render 'icon-42', name: 'swiper-btn' %}</div>
        </div>
      </div>
    </div>
  </div>
</div>

{% schema %}
{
  "name": "42 Self journal slider",
  "tag": "section",
  "settings": [
    {
      "type": "text",
      "id": "section_id",
      "label": "Section id",
      "default": "self-journal"
    },
    {
      "type": "metaobject_list",
      "id": "metaobject_content",
      "metaobject_type": "journal_content",
      "label": "Metaobject"
    },
    {
      "type": "richtext",
      "id": "section_title",
      "label": "Section title"
    },
    {
      "type": "text",
      "id": "section_text",
      "label": "Section text"
    },
    {
      "type": "text",
      "id": "btn_text",
      "label": "Button text"
    },
    {
      "type": "header",
      "content": "Padding Y settings"
    },
    {
      "type": "number",
      "id": "pt_mob",
      "label": "Mobile padding top in px",
      "default": 56
    },
    {
      "type": "number",
      "id": "pb_mob",
      "label": "Mobile padding bottom in px",
      "default": 56
    },
    {
      "type": "number",
      "id": "pt_tab",
      "label": "Tablet padding top in px",
      "default": 60
    },
    {
      "type": "number",
      "id": "pb_tab",
      "label": "Tablet padding bottom in px",
      "default": 60
    },
    {
      "type": "number",
      "id": "pt_desk",
      "label": "Desktop padding top in px",
      "default": 80
    },
    {
      "type": "number",
      "id": "pb_desk",
      "label": "Desktop padding bottom in px",
      "default": 84
    }
  ],
  "blocks": [
    {
      "name": "Item",
      "type": "item",
      "limit": 4,
      "settings": [
        {
          "type": "text",
          "id": "name_pagination",
          "label": "Name pagination"
        },
        {
          "type": "image_picker",
          "id": "image_default",
          "label": "Image default"
        },
        {
          "type": "image_picker",
          "id": "image_active",
          "label": "Image active"
        },
        {
          "type": "text",
          "id": "text",
          "label": "Text"
        },
        {
          "type": "text",
          "id": "text_active",
          "label": "Text active"
        }
      ]
    }
  ],
  "presets": [
    {
      "name": "42 Self journal slider"
    }
  ]
}
{% endschema %}
