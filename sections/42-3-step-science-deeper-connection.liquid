{% liquid
  assign anchor_id = section.settings.anchor_id | handleize

  assign title = section.settings.title
  assign text = section.settings.text

  assign metaobject_content = section.settings.metaobject_content | first

  if metaobject_content != blank
    assign metaobject_title = metaobject_content.title
    assign metaobject_text = metaobject_content.text | metafield_tag
    if metaobject_title != blank
      assign title = metaobject_title
    endif
    if metaobject_text != blank
      assign text = metaobject_text
    endif
  endif

  assign blocks = section.blocks

  assign pt_mob = section.settings.pt_mob
  assign pb_mob = section.settings.pb_mob
  assign pt_tab = section.settings.pt_tab
  assign pb_tab = section.settings.pb_tab
  assign pt_desk = section.settings.pt_desk
  assign pb_desk = section.settings.pb_desk
%}

{% render 'section-paddings',
  section_id: section.id,
  pt_mob: pt_mob,
  pb_mob: pb_mob,
  pt_tab: pt_tab,
  pb_tab: pb_tab,
  pt_desk: pt_desk,
  pb_desk: pb_desk
%}

<div
  data-section-id="{{ section.id }}"
  id="{{ anchor_id }}"
  class="tw-bg-sc-blue"
>
  <div class="container-42">
    <div class="lg:tw-rounded-[40px] lg:tw-overflow-hidden lg:tw-bg-sc-ice-blue lg:tw-py-14 lg:tw-px-10.5">
      <div class="lg:tw-flex lg:tw-gap-[58px]">
        {% if title != blank %}
          <h2 class="tw-font-bold tw-text-[28px] tw-leading-9 tw-text-white lg:tw-max-w-[494px] lg:tw-text-[38px] lg:tw-leading-[45px] lg:tw-text-sc-blue lg:tw-flex-shrink-0">
            {{ title }}
          </h2>
        {% endif %}
        {% if text != blank %}
          <div class="tw-text-white tw-text-base tw-mt-4 lg:tw-text-lg lg:tw-leading-6 lg:tw-text-sc-blue">
            {{ text }}
          </div>
        {% endif %}
      </div>
      <div
        class="swiper tw-opacity-0 tw-mt-8 lg:tw-mt-18"
        x-ignore
        ax-load
        x-data="swiperSlider($el, 'steps_science', { navigation: { nextEl: '.slider-button-next-{{ section.id }}', prevEl: '.slider-button-prev-{{ section.id }}' }})"
      >
        <div class="swiper-wrapper">
          {% if metaobject_content != blank %}
            {% for i in (1..3) %}
              {% capture title_key %}step_{{- i -}}_title{% endcapture %}
              {% capture text_key %}step_{{- i -}}_text{% endcapture %}

              {% liquid
                assign heading = metaobject_content[title_key]
                assign description = metaobject_content[text_key] | metafield_tag
                assign number = i | prepend: '0'
              %}
              <div class="swiper-slide">
                {% render '42-3-step-slide', id: i, heading: heading, description: description, number: number %}
              </div>
            {% endfor %}
          {% else %}
            {% for block in blocks %}
              {% liquid
                assign heading = block.settings.heading
                assign description = block.settings.description
                assign number = forloop.index | prepend: '0'
              %}
              <div class="swiper-slide">
                {% render '42-3-step-slide', id: block.id, heading: heading, description: description, number: number %}
              </div>
            {% endfor %}
          {% endif %}
        </div>

        <div class="tw-flex tw-gap-[13px] tw-mt-6 lg:tw-hidden justify-center">
          <div
            id="steps-science-prev"
            class="slider-button-prev-{{ section.id }} tw-flex tw-size-9 tw-rounded-full tw-border tw-border-solid tw-border-white tw-text-white"
          >
            {% render 'icon-42', name: 'swiper-btn', class: 'tw-rotate-180' %}
          </div>
          <div
            id="steps-science-next"
            class="slider-button-next-{{ section.id }} tw-flex tw-size-9 tw-rounded-full tw-border tw-border-solid tw-border-white tw-text-white"
          >
            {% render 'icon-42', name: 'swiper-btn' %}
          </div>
        </div>
      </div>
    </div>
  </div>
</div>

{% schema %}
{
  "name": "3-Step Science of Deeper",
  "tag": "section",
  "disabled_on": {
    "groups": ["header", "footer"]
  },
  "settings": [
    {
      "type": "text",
      "id": "anchor_id",
      "label": "Anchor id",
      "default": "section-name"
    },
    {
      "type": "metaobject_list",
      "id": "metaobject_content",
      "metaobject_type": "the_3_step",
      "label": "Metaobject",
      "info": "If you use metaobjects, the section title and section text are taken from the metaobject"
    },
    {
      "type": "text",
      "id": "title",
      "label": "Title",
      "default": "The 3-Step Science of Deeper Connection"
    },
    {
      "type": "richtext",
      "id": "text",
      "label": "Text",
      "default": "<p>The Intimacy Deck isn’t just a game—it’s a relationship catalyst powered by psychology. This simple yet powerful 3-step process helps you unlock deeper emotional intimacy, one conversation at a time.</p>"
    },
    {
      "type": "header",
      "content": "Padding Y settings"
    },
    {
      "type": "number",
      "id": "pt_mob",
      "label": "Mobile padding top in px",
      "default": 0
    },
    {
      "type": "number",
      "id": "pb_mob",
      "label": "Mobile padding bottom in px",
      "default": 0
    },
    {
      "type": "number",
      "id": "pt_tab",
      "label": "Tablet padding top in px",
      "default": 0
    },
    {
      "type": "number",
      "id": "pb_tab",
      "label": "Tablet padding bottom in px",
      "default": 0
    },
    {
      "type": "number",
      "id": "pt_desk",
      "label": "Desktop padding top in px",
      "default": 0
    },
    {
      "type": "number",
      "id": "pb_desk",
      "label": "Desktop padding bottom in px",
      "default": 0
    }
  ],
  "blocks": [
    {
      "type": "block",
      "name": "Block",
      "settings": [
        {
          "type": "text",
          "id": "heading",
          "label": "Heading"
        },
        {
          "type": "text",
          "id": "description",
          "label": "Description"
        }
      ]
    }
  ],
  "presets": [
    {
      "name": "3-Step Science of Deeper Connection"
    }
  ]
}
{% endschema %}
